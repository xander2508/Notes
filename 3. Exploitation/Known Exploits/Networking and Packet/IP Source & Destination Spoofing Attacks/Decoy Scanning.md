In an attempt to bypass firewall restrictions, an attacker might change the source IP of packets to enumerate further information about a host in another network segment. Through changing the source to something within the same subnet as the target host, the attacker might succeed in firewall evasion.

Simply put, when an attacker wants to gather information, they might change their source address to be the same as another legitimate host, or in some cases entirely different from any real host. This is to attempt to evade IDS/Firewall controls, and it can be easily observed.

#### Detection

In the case of decoy scanning, we will notice some strange behaviour.

1. `Initial Fragmentation from a fake address`
2. `Some TCP traffic from the legitimate source address`

![[1-decoy.webp]]

Secondarily, in this attack the attacker might be attempting to cloak their address with a decoy, but the responses for multiple closed ports will still be directed towards them with the RST flags denoted for TCP.

![[2-decoy.webp]]

#### Mitigations

As such, another simple way that we can prevent this attack beyond just detecting it through our traffic analysis efforts is the following.
1. `Have our IDS/IPS/Firewall act as the destination host would` - In the sense that reconstructing the packets gives a clear indication of malicious activity.
2. `Watch for connections started by one host, and taken over by another` - The attacker after all has to reveal their true source address in order to see that a port is open. This is strange behavior and we can define our rules to prevent it.