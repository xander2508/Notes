---
tags:
  - Exploitation
  - KnownExploits
  - NetworkingAndPackets
---
In order to find irregularities in handshakes, we can utilize TCP dump and Wireshark as we have done before. In order to filter to only handshake messages we can use this filter in Wireshark.

- `ssl.record.content_type == 22`

The content type 22 specifies handshake messages only. Specifying this filter we should get a view like the following.

![Handshake Messages](https://academy.hackthebox.com/storage/modules/229/1-HTTPs.png)

When we are looking for SSL renegotiation attacks, we can look for the following.

1. `Multiple Client Hellos` - This is the most obvious sign of an SSL renegotiation attack. We will notice multiple client hellos from one client within a short period like above. The attacker repeats this message to trigger renegotiation and hopefully get a lower cipher suite.
2. `Out of Order Handshake Messages` - Simply put, sometimes we will see some out of order traffic due to packet loss and others, but in the case of SSL renegotiation some obvious signs would be the server receiving a client hello after completion of the handshake.
    

An attacker might conduct this attack against us for the following reasons

1. `Denial of Service` - SSL renegotiation attacks consume a ton of resources on the server side, and as such it might overwhelm the server and cause it to be unresponsive.
    
2. `SSL/TLS Weakness Exploitation` - The attacker might attempt renegotiation to potentially exploit vulnerabilities with our current implementation of cipher suites.
    
3. `Cryptanalysis` - The attacker might use renegotiation as a part of an overall strategy to analyse our SSL/TLS patterns for other systems.