---
tags:
  - Exploitation
  - OperatingSystems
  - Windows
  - Tooling
  - Impacket
---
This module performs the SMB Relay attacks originally discovered by `cDc` extended to many target protocols (SMB, MSSQL, LDAP, etc). It receives a list of targets and for every connection received it will choose the next target and try to relay the credentials. Also, if specified, it will first to try authenticate against the client connecting to us.

## Usage

##### Responder Relay Attack

By default, `impacket-ntlmrelayx` will dump the SAM database, but we can execute commands by adding the option `-c` (e.g. run a command line reverse shell).

Since the Microsoft [**MS08-068**](https://docs.microsoft.com/en-us/security-updates/securitybulletins/2008/ms08-068) vulnerability patch, you cannot relay NTLMv1/v2 authentication to the same machine from which it came

1. First you’ll want to identify machines in the network that don’t require SMB signing. Responder has a neat tool packaged with it called [[RunFinger]] that can scan subnets for Windows devices and show if SMB signing is required.
2. Set SMB and HTTP to `OFF` in our responder configuration file (`/etc/responder/Responder.conf`).
3. Run [[1. Responder|Responder]] with options `-rv`
4. Run the following command:

```shell-session
impacket-ntlmrelayx --no-http-server -smb2support -t 10.10.110.146
```

