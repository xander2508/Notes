---
tags:
  - Exploitation
  - FileTypesAndData
  - Malware
  - MalwareProgramsandExecutables
  - DynamicAnalysis
  - FileTypesandData
---
When it comes to the domain of malware analysis, dynamic or behavioural analysis represents an indispensable approach in our investigative arsenal. In dynamic analysis, we observe and interpret the behaviour of the malware while it is running, or in action. This is a critical contrast to static analysis, where we dissect the malware's properties and contents without executing it. The primary goal of dynamic analysis is to document and understand the real-world impact of the malware on its host environment, making it an integral part of comprehensive malware analysis.

Our dynamic analysis procedure can be broken down into the following steps:

1. `Environment Setup`: We first establish a secure and controlled environment, typically a `VM`, isolated from the rest of the network to prevent inadvertent contamination or propagation of the malware. The VM setup should mimic a real-world system, complete with software, applications, and network configurations that an actual user might have.
   See [[#Sandboxes]]
2. `Baseline Capture`: After the environment is set up, we capture a snapshot of the system's clean state. This baseline serves as a reference point to identify changes made by the malware post-execution.
3. `Tool Deployment (Pre-Execution)`: To capture the activities of the malware effectively, we deploy various monitoring and logging tools. Tools such as [[Process Monitor (ProcMon)]] from Sysinternals Suite are used to log system calls, file system activity, registry operations, etc. We can also employ utilities like [[Wireshark]], `tcpdump`, and [[Fiddler]] for capturing network traffic, and [[RegShot]] to take before-and-after snapshots of the system registry. Finally, tools such as [[INetSim]], [[FakeDNS]], and [[FakeNet-NG]] are used to simulate internet services.
4. `Malware Execution`: With our tools running and ready, we proceed to execute the malware sample in the isolated environment. During execution, the monitoring tools capture and log all activities, including process creation, file and registry modifications, network traffic, etc.
5. `Observation and Logging`: The malware sample is allowed to execute for a sufficient duration. All the while, our monitoring tools are diligently recording its every move, which will provide us with comprehensive insight into its behaviour and modus operandi.
6. `Analysis of Collected Data`: After the malware has run its course, we halt its execution and stop the monitoring tools. We now examine the logs and data collected, comparing the system's state to our initial baseline to identify the changes introduced by the malware.


### Sandboxes

Sandboxes, such as `Cuckoo Sandbox`, `Joe Sandbox`, or `FireEye's Dynamic Threat Intelligence cloud`, provide an automated, safe, and highly controlled environment for malware execution. They come equipped with numerous features for in-depth behavioural analysis and generate detailed reports regarding the malware's network behaviour, file system interaction, memory footprint, and more.

However, it's important to remember that while sandbox environments are valuable tools, they are not fool proof. Some advanced malware can detect sandbox environments and alter their behaviour accordingly, making it harder for researchers to ascertain their true nature.