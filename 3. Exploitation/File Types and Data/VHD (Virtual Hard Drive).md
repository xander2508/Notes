---
tags:
  - Exploitation
  - FileTypesAndData
  - FileTypesandData
aliases:
  - Bitlocker Encrypted Drives
---

## Guide

1. [\[ubuntu\] How do you mount a VHD image](https://ubuntuforums.org/showthread.php?t=2299701)

## Walkthrough
 
1. [Hack The Box - Bastion - 0xRick’s Blog](https://0xrick.github.io/hack-the-box/bastion/)

## Bitlocker Encrypted Drives

[BitLocker](https://docs.microsoft.com/en-us/windows/security/information-protection/bitlocker/bitlocker-device-encryption-overview-windows-10) is an encryption program for entire partitions and external drives. Microsoft developed it for the Windows operating system. It has been available since Windows Vista and uses the `AES` encryption algorithm with 128-bit or 256-bit length. If the password or PIN for BitLocker is forgotten, we can use the recovery key to decrypt the partition or drive. The recovery key is a 48-digit string of numbers generated during BitLocker setup that also can be brute-forced.

```shell-session
bitlocker2john -i Backup.vhd > backup.hashes
```

```shell-session
grep "bitlocker\$0" backup.hashes > backup.hash
```

See [[Hashcat]] and [[John the Ripper|John]]

```shell-session
hashcat -m 22100 backup.hash /opt/useful/seclists/Passwords/Leaked-Databases/rockyou.txt -o backup.cracked
```

[GitHub - Aorimn/dislocker: FUSE driver to read/write Windows' BitLocker-ed volumes under Linux / Mac OSX](https://github.com/Aorimn/dislocker)

```shell
sudo apt-get install dislocker
```

Subsequently, mount the drive as a loopback device and use `dislocker` in order to access the files:

```shell
sudo mkdir -p /media/bitlocker
sudo mkdir -p /media/bitlockermount
sudo losetup -f -P Backup.vhd
sudo dislocker /dev/loop0p2 -u123456789! -- /media/bitlocker
sudo mount -o loop /media/bitlocker/dislocker-file /media/bitlockermount
```