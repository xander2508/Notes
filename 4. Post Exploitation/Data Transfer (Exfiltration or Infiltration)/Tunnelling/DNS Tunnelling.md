---
tags:
  - PostExploitation
  - DataTransfer
  - Tunnelling
---
| **Step**                                 | **Description**                                                                                                                                                                                                                                         |
| ---------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `1. Data Exfiltration`                   | As shown in [[#Identifying DNS Tunnelling]] DNS tunnelling can be helpful for attackers trying to get data out of our network without getting caught.                                                                                                   |
| `2. Command and Control`                 | Some malware and malicious agents will utilize DNS tunneling on compromised systems in order to communicate back to their command and control servers. Notably, we might see this method of usage in botnets.                                           |
| `3. Bypassing Firewalls and Proxies`     | DNS tunneling allows attackers to bypass firewalls and web proxies that only monitor HTTP/HTTPs traffic. DNS traffic is traditionally allowed to pass through network boundaries. As such, it is important that we monitor and control this traffic.    |
| `4. Domain Generation Algorithms (DGAs)` | Some more advanced malware will utilize DNS tunnels to communicate back to their command and control servers that use dynamically generated domain names through DGAs. This makes it much more difficult for us to detect and block these domain names. |

## Identifying DNS Tunnelling

 If you notice a good amount of text records from one host. This could indicate DNS tunnelling. Like ICMP tunnelling, attackers can and have utilized DNS forward and reverse lookup queries to perform data exfiltration. They do so by appending the data they would like to exfiltrate as a part of the TXT field.
 
 ![[3-DNSTraffic.webp]]

![[4-DNSTraffic.webp]]

