---
tags:
  - PostExploitation
  - OperatingSystems
---
# Guide

1. A extensive list of [Hijacking DLLs in Windows](https://www.wietzebeukema.nl/blog/hijacking-dlls-in-windows) 
2. [Windows Local Privilege Escalation - Services (DLL Hijacking) - YouTube](https://www.youtube.com/watch?v=9s8jYwx9FSA&list=PLjG9EfEtwbvIrGFTx4XctK8IxkUJkAEqP&index=4)


# Examples 

1. See [[System Monitor (Sysmon)#Detection Example 1 Detecting DLL Hijacking]]
2. See [[System Monitor (Sysmon)#Detection Example 2 Detecting Unmanaged PowerShell/C-Sharp Injection]] for DLL injection
# Tooling

1. Stephen Fewer's "hello world" [reflective DLL](https://github.com/stephenfewer/ReflectiveDLLInjection/tree/master/bin)


Below is an example of identifying process injection using DLL imports and function names:

![[process_injection_fn.webp]]In this diagram, the malware process (`shell.exe`) performs process injection to inject code into a target process (`notepad.exe`) using the following functions imported from the DLL `kernel32.exe`:

- `OpenProcess`: Opens a handle to the target process (notepad.exe), providing the necessary access rights to manipulate its memory.
- `VirtualAllocEx`: Allocates a block of memory within the address space of the target process to store the injected code.
- `WriteProcessMemory`: Writes the desired code into the allocated memory block of the target process.
- `CreateRemoteThread`: Creates a new thread within the target process, specifying the entry point of the injected code as the starting point.

As a result, the injected code is executed within the context of the target process by the newly created remote thread. This technique allows the malware to run arbitrary code within the target process.