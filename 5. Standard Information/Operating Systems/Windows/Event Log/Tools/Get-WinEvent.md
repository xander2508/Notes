The `Get-WinEvent` cmdlet is an indispensable tool in PowerShell for querying Windows Event logs en masse. The cmdlet provides us with the capability to retrieve different types of event logs, including classic Windows event logs like System and Application logs, logs generated by Windows Event Log technology, and Event Tracing for Windows (ETW) logs.

#### Listing Logs

```powershell-session
Get-WinEvent -ListLog * | Select-Object LogName, RecordCount, IsClassicLog, IsEnabled, LogMode, LogType | Format-Table -AutoSize
```

#### List Providers

```powershell-session
Get-WinEvent -ListProvider * | Format-Table -AutoSize
```
#### Retrieve Specific Provider Logs

```powershell-session
Get-WinEvent -ListLog Security
```

## Generic Retrieval Commands

#### Retrieving events from the System log

```powershell-session
Get-WinEvent -LogName 'System' -MaxEvents 50 | Select-Object TimeCreated, ID, ProviderName, LevelDisplayName, Message | Format-Table -AutoSize
```

#### Querying Last Five Events

Here we will list the last five events recorded in the Security log. By default, the newest logs are listed first. If we want to get older logs first, we can reverse the order to list the oldest ones first using the `-Oldest` parameter.

We can query for the last X number of events, looking specifically for the last five events using the `-MaxEvents` parameter.

```powershell-session
Get-WinEvent -LogName 'Security' -MaxEvents 5 | Select-Object -ExpandProperty Message
```

From here, we could use the `-ExpandProperty` parameter to dig deeper into specific events, list logs from oldest to newest, etc.

#### Filtering

```powershell-session
Get-WinEvent -FilterHashTable @{LogName='Security';ID='4625 '}
```

```powershell-session
Get-WinEvent -FilterHashTable @{LogName='System';Level='1'} | select-object -ExpandProperty Message
```

```
$time1 =  get-date('08/03/2022 10:23:24')
```
```
$time2 =  get-date('08/03/2022 10:23:26')```
```
```
Get-WinEvent -FilterHashtable @{LogName = 'Security'; Id = 4624; StartTime = $time1; EndTime = $time2 } 
```

```
Get-WinEvent -FilterHashtable @{
    LogName = 'Security';
    Id = 4907
} | Where-Object {
    $_.Properties | Where-Object {
        $_.Value -eq '0x3E7'
    }
}

```

```
Get-WinEvent -FilterHashtable @{
    LogName = 'Security';
    Id = 4907
} | Where-Object {
    $_.Properties | Where-Object {
        $_.Value -eq '0x3E7'
    }
} | ForEach-Object {
    $xml = [xml]$_.ToXml()
    $processName = $xml.Event.EventData.Data | Where-Object { $_.Name -eq "ProcessName" }
    [PSCustomObject]@{
        TimeCreated = $_.TimeCreated
        EventId = $_.Id
        ProcessName = $processName.'#text'
    }
}

```