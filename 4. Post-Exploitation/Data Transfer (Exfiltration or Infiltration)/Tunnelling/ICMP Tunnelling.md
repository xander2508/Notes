---
tags:
  - Post-Exploitation
  - DataTransfer
  - Tunnelling
---

In the case of ICMP tunnelling an attacker will append data they want to exfiltrate to the outside world or another host in the data field in an ICMP request. This is done with the intention to hide this data among a common protocol type like ICMP, and hopefully get lost within our network traffic.

![[Pasted image 20240816161106.jpg]]

## Finding ICMP Tunnelling

Since ICMP tunnelling is primarily done through an attacker adding data into the data field for ICMP, we can find it by looking at the contents of data per request and reply.

![[3-ICMP-tunneling.webp]]

In many cases, if the ICMP data length is larger than 48-bytes, we know something fishy is going on, and should always look into it.

## Preventing ICMP Tunnelling

In order to prevent ICMP tunnelling from occurring we can conduct the following actions.

1. `Block ICMP Requests` - Simply, if ICMP is not allowed, attackers will not be able to utilize it.
    
2. `Inspect ICMP Requests and Replies for Data` - Stripping data, or inspecting data for malicious content on these requests and replies can allow us better insight into our environment, and the ability to prevent this data exfiltration.