---
tags:
  - Post-Exploitation
  - Cryptography
  - HashesAndEncryption
  - Hashes
aliases:
  - NTLM
  - LM
---
Microsoft's [Windows New Technology LAN Manager (NTLM)](https://learn.microsoft.com/en-us/windows-server/security/kerberos/ntlm-overview) is a set of security protocols that authenticates users' identities while also protecting the integrity and confidentiality of their data. NTLM is a single sign-on (SSO) solution that uses a challenge-response protocol to verify the user's identity without having them provide a password.

Despite its known flaws, NTLM is still commonly used to ensure compatibility with legacy clients and servers, even on modern systems. While Microsoft continues to support LM, NTLM, NTLMv1, and NTLMv2 (LM and NTLM here are the hash names, and NTLMv1 and NTLMv2 are authentication protocols that utilize the LM or NT hash), Kerberos has taken over as the default authentication mechanism in Windows 2000 and subsequent [[What is Active Directory|Active Directory]] (AD) domains.

|**Hash/Protocol**|**Cryptographic technique**|**Mutual Authentication**|**Message Type**|**Trusted Third Party**|
|---|---|---|---|---|
|`NTLM`|Symmetric key cryptography|No|Random number|Domain Controller|
|`NTLMv1`|Symmetric key cryptography|No|MD4 hash, random number|Domain Controller|
|`NTLMv2`|Symmetric key cryptography|No|MD4 hash, random number|Domain Controller|
|`Kerberos`|Symmetric key cryptography & asymmetric cryptography|Yes|Encrypted ticket using DES, MD5|Domain Controller/Key Distribution Center (KDC)|
With NTLM, passwords stored on the server and domain controller are not "salted," which means that an adversary with a password hash can authenticate a session without knowing the original password. See [[Pass the Hash (PtH)]].

Windows [[What is Active Directory|Active Directory]] uses multiple forms of authentication which include  Below is a quick comparison between these hashes and protocols, which shows us that, while not perfect by any means, Kerberos is often the authentication protocol of choice wherever possible
# Guide

1. Example hash: ```
		`[Jason, :, 502, :, aad3c435b514a4eeaad3b935b51304fe, :, c46b9e588fa0d112de6f59fd6d58eae3, :, :, :] `
	* `Jason` is the user name
	- `502` is the relative identifier (500 is an administrator, 502 here is a Kerberos account.) [Kerberos Account](https://adsecurity.org/?p=483)
	- `aad3c435b514a4eeaad3b935b51304f` is the LM hash
	- `c46b9e588fa0d112de6f59fd6d58eae3` is the NT hash

2. Difference between NT and LM, see [explanation](http://www.adshotgyan.com/2012/02/lm-hash-and-nt-hash.html)

## Usages

1. [[Pass the Hash (PtH)|Pass the Hash]]
2. [[Hashcat]]
3. [[1. Responder|Responder]]
4. [[MultiRelay]]