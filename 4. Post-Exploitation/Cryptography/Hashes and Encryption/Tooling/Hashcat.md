---
tags:
  - Post-Exploitation
  - Cryptography
  - HashesAndEncryption
  - Tooling
---
Example hashes and their associated Hashcat number can be found: [[4. Post-Exploitation/Cryptography/Hashes and Encryption/1. Guide#Example Hashes|Guide]]

## Man Page

[Hashcat wiki](https://hashcat.net/wiki/doku.php?id=hashcat)

## Attack Modes

- [Dictionary attack](https://hashcat.net/wiki/doku.php?id=dictionary_attack "dictionary_attack") - Trying all words in a list; also called “straight” mode (attack mode 0, `-a 0`)
- [Combinator attack](https://hashcat.net/wiki/doku.php?id=combinator_attack "combinator_attack") - Concatenating words from multiple wordlists (`-a 1`)
- [Brute-force attack](https://hashcat.net/wiki/doku.php?id=mask_attack "mask_attack") and [Mask attack](https://hashcat.net/wiki/doku.php?id=mask_attack "mask_attack") - trying all characters from given charsets, per position (`-a 3`)
- [Hybrid attack](https://hashcat.net/wiki/doku.php?id=hybrid_attack "hybrid_attack") - Combining wordlists + masks (`-a 6`) and masks + wordlists (`-a 7`); can [also be done with rules](https://hashcat.net/wiki/doku.php?id=toggle_attack_with_rules "toggle_attack_with_rules")
- [Association attack](https://hashcat.net/wiki/doku.php?id=association_attack "association_attack") - Use an username, a filename, a hint, or any other pieces of information which could have had an influence in the password generation to attack one specific hash (`-a 9`)
## Rules Based Brute-Forcing

If a prospective password is known to be a variant of a specific pattern we can use rules to vary a known password.

Good rules for variation:
1. [Hob0Rules](https://github.com/praetorian-inc/Hob0Rules)
2. [best64.rule](https://github.com/samirettali/password-cracking-rules/blob/master/best64.rule)

Existing rules:

```shell-session
ls /usr/share/hashcat/rules/
```
#### Word List Generation

```shell-session
hashcat --force password.list -r custom.rule --stdout | sort -u > mut_password.list
```

## Example Commands

```
hashcat -m 13100 -a 0 GetUserSPNs.out /usr/share/wordlists/rockyou.txt
```

```
hashcat -m 300 -a 0 hash /usr/share/wordlists/rockyou.txt -r OneRuleToRuleThemAll.rule --debug-mode=1 --debug-file=matched.rule
```
### IPMI

Mode `7300`

In the event of an HP iLO using a factory default password, we can use this Hashcat mask attack command:
```
hashcat -m 7300 ipmi.txt -a 3 ?1?1?1?1?1?1?1?1 -1 ?d?u
```

Otherwise:

```shell-session
hashcat -m 7300 -w 3 -O "HASH" /usr/share/wordlists/rockyou.txt
```

### NT Hashes 

For hashes from Windows and SAM files.

```shell-session
sudo hashcat -m 1000 hashestocrack.txt /usr/share/wordlists/rockyou.txt
```