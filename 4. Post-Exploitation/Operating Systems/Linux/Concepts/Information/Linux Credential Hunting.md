---
tags:
  - Post-Exploitation
  - OperatingSystems
  - Linux
  - Concepts
  - Information
aliases:
  - Linux Password Hunting
---
#### Key Areas to Search  

| **`Files`**  | **`History`**        | **`Memory`**         | **`Key-Rings`**            |
| ------------ | -------------------- | -------------------- | -------------------------- |
| Configs      | Logs                 | Cache                | Browser stored credentials |
| Databases    | Command-line History | In-memory Processing |                            |
| Notes        |                      |                      |                            |
| Scripts      |                      |                      |                            |
| Source codes |                      |                      |                            |
| Cronjobs     |                      |                      |                            |
| SSH Keys     |                      |                      |                            |

#### Configuration Files

```shell-session
for l in $(echo ".conf .config .cnf");do echo -e "\nFile extension: " $l; find / -name *$l 2>/dev/null | grep -v "lib\|fonts\|share\|core" ;done
```

Search for credentials in each file found:

```shell-session
for i in $(find / -name *.cnf 2>/dev/null | grep -v "doc\|lib");do echo -e "\nFile: " $i; grep "user\|password\|pass" $i 2>/dev/null | grep -v "\#";done
```

## Databases 

```shell-session
for l in $(echo ".sql .db .*db .db*");do echo -e "\nDB File extension: " $l; find / -name *$l 2>/dev/null | grep -v "doc\|lib\|headers\|share\|man";done
```

## Notes 

```shell-session
find /home/* -type f -name "*.txt" -o ! -name "*.*"
```

## Scripts

```shell-session
for l in $(echo ".py .pyc .pl .go .jar .c .sh");do echo -e "\nFile extension: " $l; find / -name *$l 2>/dev/null | grep -v "doc\|lib\|headers\|share";done
```

## Cronjobs

See [[CRON Jobs]]

```shell-session
cat /etc/crontab 
```

```shell-session
ls -la /etc/cron.*/
```


## SSH Keys

```shell-session
grep -rnw "PRIVATE KEY" /home/* 2>/dev/null | grep ":1"
```

```shell-session
grep -rnw "ssh-rsa" /home/* 2>/dev/null | grep ":1"
```

## History

```shell-session
tail -n5 /home/*/.bash*
```

## Logs 

```shell-session
for i in $(ls /var/log/* 2>/dev/null);do GREP=$(grep "accepted\|session opened\|session closed\|failure\|failed\|ssh\|password changed\|new user\|delete user\|sudo\|COMMAND\=\|logs" $i 2>/dev/null); if [[ $GREP ]];then echo -e "\n#### Log file: " $i; grep "accepted\|session opened\|session closed\|failure\|failed\|ssh\|password changed\|new user\|delete user\|sudo\|COMMAND\=\|logs" $i 2>/dev/null;fi;done
```

## Memory and Cache

With administrator/root permissions:

1. [[MimiPenguin]]
2. [[The LaZagne Project]]

## Browsers

Browsers store the passwords saved by the user in an encrypted form locally on the system to be reused.

### Firefox

```shell-session
ls -l .mozilla/firefox/ | grep default 
```

```shell-session
cat .mozilla/firefox/1bplpd86.default-release/logins.json | jq .
```

See [[Firefox Decrypt]] and [[The LaZagne Project]]