---
tags:
  - Post-Exploitation
  - OperatingSystems
  - Windows
  - Concepts
  - Information
---
In this attack, we use a stolen Kerberos ticket to move laterally instead of an NTLM password hash.

We need a valid Kerberos ticket to perform a `Pass the Ticket (PtT)`. It can be:

- Service Ticket (TGS - Ticket Granting Service) to allow access to a particular resource.
- Ticket Granting Ticket (TGT), which we use to request service tickets to access any resource the user has privileges.

# From Windows
## Obtaining a Ticket 

Administer privileges are required to obtain all tickets.

On Windows, tickets are processed and stored by the LSASS (Local Security Authority Subsystem Service) process. Therefore, to get a ticket from a Windows system, you must communicate with LSASS and request it. As a non-administrative user, you can only get your tickets, but as a local administrator, you can collect everything.

See [[Mimikatz#Export Tickets]] or [[Rubeus]]

The tickets that end with `$` correspond to the computer account, which needs a ticket to interact with the Active Directory. 

User tickets have the user's name, followed by an `@` that separates the service name and the domain, for example: `[randomvalue]-username@service-domain.local.kirbi`.

> [!NOTE]
> If you pick a ticket with the service krbtgt, it corresponds to the TGT of that account.

#### Pass the Key or OverPass the Hash

The traditional `Pass the Hash (PtH)` technique involves reusing an NTLM password hash that doesn't touch Kerberos. The `Pass the Key` or `OverPass the Hash` approach converts a hash/key (rc4_hmac, aes256_cts_hmac_sha1, etc.) for a domain-joined user into a full `Ticket-Granting-Ticket (TGT)`. This technique was developed by Benjamin Delpy and Skip Duckwall in their presentation [Abusing Microsoft Kerberos - Sorry you guys don't get it](https://www.slideshare.net/gentilkiwi/abusing-microsoft-kerberos-sorry-you-guys-dont-get-it/18). Also [Will Schroeder](https://twitter.com/harmj0y) adapted their project to create the [Rubeus](https://github.com/GhostPack/Rubeus) tool.

See [example](https://github.com/GhostPack/Rubeus#example-over-pass-the-hash) attack.
##### Extract Kerberos Keys

See [[Mimikatz#Extract Kerberos Keys]]

#### Pass the Key or OverPass the Hash

See [[Mimikatz#Pass the Key or OverPass the Hash]] or [[Rubeus]]

> [!NOTE]
> Mimikatz requires administrative rights to perform the Pass the Key/OverPass the Hash attacks, while Rubeus doesn't.

## Pass the Ticket

See [[Rubeus#Pass the Ticket]] or [[Mimikatz#Pass the Ticket]]

## Pass The Ticket with PowerShell Remoting

See [[PowerShell Remoting]]

To use PowerShell Remoting with Pass the Ticket, we can use Mimikatz to import our ticket and then open a PowerShell console and connect to the target machine.

See [[Mimikatz#Pass The Ticket with PowerShell Remoting]] or [[Rubeus]]












